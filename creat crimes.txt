-- Creates the "crimes" table, which links criminals and officers to specific crime events.

CREATE TABLE public.crimes (
  -- 'id' is the primary key for this table, auto-generating.
  id bigint generated by default as identity primary key,

  -- 'crime_type' describes the nature of the crime (e.g., 'Theft', 'Burglary').
  crime_type text not null,

  -- 'date_committed' is the date the crime occurred.
  date_committed date,

  -- 'location' stores the address or area where the crime took place.
  location text,

  -- 'description' provides more details about the crime event.
  description text,

  -- Foreign key linking to the 'criminals' table.
  -- This identifies who committed the crime.
  -- 'on delete set null' means if a criminal is deleted, this field will become null.
  criminal_id bigint references public.criminals(id) on delete set null,

  -- Foreign key linking to the 'officers' table.
  -- This identifies the lead investigating officer for the crime.
  officer_id bigint references public.officers(id) on delete set null,

  -- 'created_at' automatically records when the crime record was entered.
  created_at timestamptz default now()
);

-- Optional: Add a comment for documentation.
COMMENT ON TABLE public.crimes IS 'Stores details of criminal events, linking them to perpetrators and investigators.';

-- Optional: Create indexes on the foreign keys for faster query performance.
CREATE INDEX idx_crimes_criminal_id ON public.crimes(criminal_id);
CREATE INDEX idx_crimes_officer_id ON public.crimes(officer_id);
